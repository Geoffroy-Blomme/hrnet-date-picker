<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: dist/Date.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: dist/Date.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import "./Date.css";
import { useState, createElement, useRef } from "react";
import { useClickOutside } from "./UseClickOutside";
import PropTypes from "prop-types";

/**
 * @description Generates an input which on focus has a Date Picker pop-up
 * @param {string} id The id of the generated input
 * @param {number} yearsBackWard The number of backward years that the scroller will go
 * @param {number} yearsForward The number of forward years that the scroller will go
 * @namespace datePicker
 * @returns {React.Component} - The Date Picker component
 */
import { jsx as _jsx } from "react/jsx-runtime";
import { jsxs as _jsxs } from "react/jsx-runtime";
const DatePicker = props => {
  const {
    id,
    yearsBackWard = 60,
    yearsForward = 60
  } = props;
  const ref = useRef();
  const [datePickerIsHidden, setDatePickerIsHidden] = useState(true);
  const labelMonthId = id + "-label_month";
  const labelYearId = id + "-label_year";
  const monthSCrollerId = id + "-month_scroller";
  const yearScrollId = id + "-year_scroller";
  const setDatePickerIsHiddenToFalse = () => {
    setDatePickerIsHidden(false);
  };
  const setDatePickerIsHiddenToTrue = () => {
    setDatePickerIsHidden(true);
  };
  useClickOutside(ref, !datePickerIsHidden, setDatePickerIsHiddenToTrue);
  const [yearMenuIsOpen, setYearMenuIsOpen] = useState(false);
  const [monthMenuIsOpen, setMonthMenuIsOpen] = useState(false);
  const currentDate = new Date();
  const currentDay = currentDate.getDate();
  const currentMonth = currentDate.getMonth();
  const currentYear = currentDate.getFullYear();
  const dayNames = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
  const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
  const [pickedYear, setPickedYear] = useState(currentYear);
  const [pickedMonth, setPickedMonth] = useState(currentMonth);
  const [pickedDay, setPickedDay] = useState(currentDay);
  const [displayedMonth, setDisplayedMonth] = useState(currentMonth);
  const [displayedYear, setDisplayedYear] = useState(currentYear);

  /**
   * When a day is picked in the Date Picker, set the the picked Day/Month/Year then closes the Date Picker
   * @memberof datePicker
   */
  const aDateIsPicked = event => {
    let dayPicked = event.target.innerText;
    let monthPicked = "" + (Number(displayedMonth) + 1);
    let yearPicked = Number(displayedYear);
    let parentNodeClassList = event.target.parentNode.classList;
    if (parentNodeClassList.value.includes("xdsoft_other_month")) {
      if (Number(dayPicked) > 7) {
        monthPicked = "" + (Number(monthPicked) - 1);
        if (monthPicked === "0") {
          monthPicked = "12";
          yearPicked = Number(displayedYear - 1);
          setDisplayedYear(yearPicked);
          setPickedYear(yearPicked);
        }
        setDisplayedMonth(monthPicked - 1);
        setPickedMonth(monthPicked - 1);
      } else {
        monthPicked = "" + (Number(monthPicked) + 1);
        if (monthPicked === "13") {
          monthPicked = "1";
          yearPicked = Number(displayedYear + 1);
          setDisplayedYear(yearPicked);
          setPickedYear(yearPicked);
          setDisplayedMonth(monthPicked - 1);
          setPickedMonth(monthPicked - 1);
        }
      }
    }
    if (monthPicked.length === 1) {
      monthPicked = "0" + monthPicked;
    }
    if (dayPicked.length === 1) {
      dayPicked = "0" + dayPicked;
    }
    setPickedDay(Number(dayPicked));
    setPickedMonth(Number(monthPicked) - 1);
    setDisplayedMonth(Number(monthPicked) - 1);
    setPickedYear(Number(yearPicked));
    setDatePickerIsHiddenToTrue();
    const input = document.querySelector(`#${id}`);
    input.value = "" + monthPicked + "/" + dayPicked + "/" + yearPicked;
  };

  /**
   * Handles the adding/removal of the '/' in the input value.
   * @memberof datePicker
   */
  const inputKeyUpHandler = event => {
    if (event.keyCode === 8) {
      if (event.target.value.length === 2 || event.target.value.length === 5) {
        event.target.value = event.target.value.slice(0, event.target.value.length - 1);
      }
    } else {
      if (event.target.value.length === 2 || event.target.value.length === 5) {
        event.target.value = event.target.value + "/";
      }
    }
  };

  /**
   * Tests if a date is correct
   * @param {string} dateStr The date to test
   * @returns true if the string is a correct Date, false otherwise
   * @memberof datePicker
   */
  const dateIsCorrect = dateStr => {
    if (dateStr.length === 10) {
      return !isNaN(new Date(dateStr));
    } else {
      return false;
    }
  };

  /**
   * Verifies that the date in the input is valid
   * @memberof datePicker
   */
  const onBlurHandler = event => {
    let datePicker = document.querySelector("#create-employee > div > div");
    if (!datePicker.contains(event.relatedTarget)) {
      if (dateIsCorrect(event.target.value)) {
        setPickedMonth(Number(event.target.value.slice(0, 2)) - 1);
        setPickedYear(Number(event.target.value.slice(6, 10)));
      } else {
        if (event.target.value !== "") {
          setPickedDay(currentDay);
          setPickedMonth(currentMonth);
          setPickedYear(currentYear);
          event.target.value = "" + "" + (Number(currentMonth) + 1) + "/" + currentDay + "/" + currentYear;
        }
      }
    }
  };

  /**
   * Makes sure that the Date in the input is not too long
   * @memberof datePicker
   */
  const inputChangedHandler = event => {
    if (event.target.value.length === 11) {
      event.target.value = event.target.value.slice(0, event.target.value.length - 1);
    }
  };

  /**
   * Toggles the Year Menu
   * @memberof datePicker
   */
  const toggleYearMenu = () => {
    if (yearMenuIsOpen) {
      setYearMenuIsOpen(false);
    } else {
      setYearMenuIsOpen(true);
    }
    setMonthMenuIsOpen(false);
  };

  /**
   * Toggles the Month Menu
   * @memberof datePicker
   */
  const toggleMonthMenu = () => {
    if (monthMenuIsOpen) {
      setMonthMenuIsOpen(false);
    } else {
      setMonthMenuIsOpen(true);
    }
    setYearMenuIsOpen(false);
  };

  /**
   * Scroll to the picked Month in the month scroller
   * @memberof datePicker
   */
  const scrollToPickedMonth = () => {
    const scrollMonths = document.querySelector("#" + monthSCrollerId);
    const options = scrollMonths.querySelectorAll(".xdsoft_option");
    let offsetTop;
    options.forEach(option => {
      if (option.getAttribute("data-value") === displayedMonth.toString()) {
        offsetTop = option.offsetTop;
      }
    });
    scrollMonths.scrollTop = offsetTop;
  };

  /**
   * Scroll to the Picked Year in the year scroller
   * @memberof datePicker
   */
  const scrollToPickedYear = () => {
    const scrollYears = document.querySelector("#" + yearScrollId);
    const options = scrollYears.querySelectorAll(".xdsoft_option");
    let offsetTop;
    options.forEach(option => {
      if (option.getAttribute("data-value") === displayedYear.toString()) {
        offsetTop = option.offsetTop;
      }
    });
    scrollYears.scrollTop = offsetTop;
  };

  /**
   * Returns the index of the first day of the Date in the days of the Week
   * @param {number} year year of the Date
   * @param {number} month month of the Date
   * @returns The index of the first day of the Date in the days of the Week
   * @memberof datePicker
   */
  function firstDayOfDate(year, month) {
    const givenDate = new Date(year.toString(), month.toString());
    return givenDate.getDay();
  }

  /**
   * Returns the last day of the Date
   * @param {number} year year of the Date
   * @param {number} month month of the Date
   * @returns The last day of the Date
   * @memberof datePicker
   */
  function lastDayOfDate(year, month) {
    const givenDate = new Date(year.toString(), (month + 1).toString(), 0);
    return givenDate.getDate();
  }

  /**
   * Generates the thead of the Date Picker
   * @returns The jsx for the thead of the Date Picker
   * @memberof datePicker
   */
  function tableHead() {
    let daysThs = [];
    dayNames.map((day, index) => {
      let dayTh = /*#__PURE__*/createElement("th", {
        children: day,
        key: index
      });
      daysThs.push(dayTh);
    });
    let row = /*#__PURE__*/createElement("tr", {
      children: daysThs
    });
    let tHead = /*#__PURE__*/createElement("thead", {
      children: row,
      key: 0
    });
    return tHead;
  }

  /**
   * Generates the calendar part of the DatePicker
   * @param {string} year The year displayed
   * @param {string} month The month displayed
   * @returns The jsx of the calendar part of the DatePicker
   * @memberof datePicker
   */
  function GenerateDays(props) {
    const {
      year,
      month
    } = props;
    const firstDayMonth = firstDayOfDate(year, month);
    const nbDaysInCurrentMonth = lastDayOfDate(year, month);
    let nbDaysLastMonth;
    if (month.toString() === "0") {
      nbDaysLastMonth = lastDayOfDate(year - 1, 11);
    } else {
      nbDaysLastMonth = lastDayOfDate(year, month - 1);
    }
    const nbOfDaysToGenerate = nbDaysInCurrentMonth + firstDayMonth + (7 - (nbDaysInCurrentMonth + firstDayMonth) % 7) % 7;
    let rows = [];
    let tds = [];
    for (let i = 0; i &lt; nbOfDaysToGenerate; i++) {
      let innerText = "";
      let classToAdd = year === currentYear &amp;&amp; month === currentMonth &amp;&amp; i - firstDayMonth + 1 === currentDay ? "xdsoft_today " : "";
      if (i - firstDayMonth + 1 === pickedDay) {
        classToAdd += "xdsoft_current";
      }
      if (i &lt; firstDayMonth || i >= nbDaysInCurrentMonth + firstDayMonth) {
        classToAdd += "xdsoft_other_month";
      } else {
        innerText = i - firstDayMonth + 1;
      }
      if (i &lt; firstDayMonth) {
        innerText = "" + nbDaysLastMonth - firstDayMonth + i + 1;
      }
      if (i >= nbDaysInCurrentMonth + firstDayMonth) {
        innerText = "" + (i - nbDaysInCurrentMonth - firstDayMonth + 1);
      }
      let div = /*#__PURE__*/createElement("div", {
        onClick: aDateIsPicked,
        key: i,
        tabIndex: innerText
      }, innerText);
      let td = /*#__PURE__*/createElement("td", {
        children: div,
        key: i,
        className: classToAdd
      });
      tds.push(td);
      if (tds.length === 7) {
        let row = /*#__PURE__*/createElement("tr", {
          children: tds,
          key: i
        });
        rows.push(row);
        tds = [];
      }
    }
    const tHead = tableHead();
    const tBody = /*#__PURE__*/createElement("tbody", {
      children: rows,
      key: 1
    });
    const table = /*#__PURE__*/createElement("table", {
      children: [tHead, tBody]
    });
    return table;
  }

  /**
   * Generates the jsx for the displayed Month and scroller month part of the Date Picker
   * @param {number} monthProp The month that must be displayed
   * @returns the jsx for the displayed Month and scroller month part of the Date Picker
   * @memberof datePicker
   */
  function MonthsScroll(props) {
    let monthProp = props.month;
    let divMonths = [];
    monthNames.forEach((month, index) => {
      let classToAdd = "";
      if (index === monthProp) {
        classToAdd += "xdsoft_current";
      }
      const divYear = /*#__PURE__*/createElement("div", {
        className: "xdsoft_option " + classToAdd,
        "data-value": index,
        onClick: () => {
          setPickedMonth(monthNames.indexOf(month));
          setDisplayedMonth(monthNames.indexOf(month));
        },
        key: index
      }, month);
      divMonths.push(divYear);
    });
    const divToReturn = /*#__PURE__*/createElement("div", {
      children: divMonths
    });
    return divToReturn;
  }

  /**
   * Generates the jsx for the displayed Year and scroller year part of the Date Picker
   * @param {number} yearProp The year that must be displayed
   * @returns the jsx for the displayed year and scroller year part of the Date Picker
   * @memberof datePicker
   */
  function YearsScroll(props) {
    let yearProp = props.year;
    let divYears = [];
    for (let i = 0; i &lt;= yearsBackWard + yearsForward; i++) {
      const year = currentYear - yearsBackWard + i;
      let classToAdd = "";
      if (typeof year !== "number") {
        console.log("weird");
      }
      if (typeof yearProp !== "number") {
        console.log("weird prop");
      }
      if (year === yearProp) {
        classToAdd += "xdsoft_current";
      }
      const divYear = /*#__PURE__*/createElement("div", {
        className: "xdsoft_option " + classToAdd,
        "data-value": year.toString(),
        key: i,
        onClick: () => {
          setPickedYear(year);
          setDisplayedYear(year);
        }
      }, year.toString());
      divYears.push(divYear);
    }
    const divToReturn = /*#__PURE__*/createElement("div", {
      style: {
        marginTop: "0px"
      },
      children: divYears
    });
    return divToReturn;
  }
  return /*#__PURE__*/_jsxs("div", {
    onBlur: onBlurHandler,
    children: [/*#__PURE__*/_jsx("input", {
      onFocus: setDatePickerIsHiddenToFalse,
      onKeyUp: inputKeyUpHandler,
      onChange: inputChangedHandler,
      id: id,
      type: "text",
      placeholder: "mm/dd/yyyy"
    }), /*#__PURE__*/_jsx("div", {
      ref: ref,
      className: "xdsoft_datetimepicker xdsoft_noselect xdsoft_",
      onClick: () => {
        if (monthMenuIsOpen) {
          setMonthMenuIsOpen(false);
        }
        if (yearMenuIsOpen) {
          setYearMenuIsOpen(false);
        }
      },
      style: {
        position: "absolute",
        display: datePickerIsHidden ? "none" : "block"
      },
      children: /*#__PURE__*/_jsxs("div", {
        className: "xdsoft_datepicker active",
        children: [/*#__PURE__*/_jsxs("div", {
          className: "xdsoft_monthpicker",
          children: [/*#__PURE__*/_jsx("button", {
            type: "button",
            className: "xdsoft_prev",
            style: {
              visibility: "visible"
            },
            onClick: () => {
              if (displayedMonth !== 0) {
                setDisplayedMonth(displayedMonth - 1);
              } else {
                setDisplayedYear(Number(displayedYear) - 1);
                setDisplayedMonth(11);
              }
            }
          }), /*#__PURE__*/_jsx("button", {
            type: "button",
            className: "xdsoft_today_button",
            style: {
              visibility: "visible"
            },
            onClick: () => {
              setPickedDay(currentDay);
              setDisplayedMonth(currentMonth);
              setPickedMonth(currentMonth);
              setDisplayedYear(currentYear);
              setPickedYear(currentYear);
            }
          }), /*#__PURE__*/_jsxs("div", {
            className: "xdsoft_label xdsoft_month",
            id: labelMonthId,
            children: [/*#__PURE__*/_jsx("span", {
              onClick: () => {
                toggleMonthMenu();
                scrollToPickedMonth();
              },
              children: monthNames[displayedMonth]
            }), /*#__PURE__*/_jsx("div", {
              className: "xdsoft_select xdsoft_monthselect xdsoft_scroller_box",
              id: monthSCrollerId,
              style: {
                visibility: monthMenuIsOpen ? "visible" : "hidden",
                overflowY: "auto"
              },
              onClick: () => {
                toggleMonthMenu();
                scrollToPickedMonth();
              },
              children: /*#__PURE__*/_jsx(MonthsScroll, {
                month: displayedMonth
              })
            }), /*#__PURE__*/_jsx("i", {
              onClick: () => {
                toggleMonthMenu();
                scrollToPickedMonth();
              }
            })]
          }), /*#__PURE__*/_jsxs("div", {
            className: "xdsoft_label xdsoft_year",
            id: labelYearId,
            children: [/*#__PURE__*/_jsx("span", {
              onClick: () => {
                toggleYearMenu();
                scrollToPickedYear();
              },
              children: displayedYear
            }), /*#__PURE__*/_jsx("div", {
              onClick: () => {
                toggleYearMenu();
                scrollToPickedYear();
              },
              className: "xdsoft_select xdsoft_yearselect xdsoft_scroller_box",
              id: yearScrollId,
              style: {
                visibility: yearMenuIsOpen ? "visible" : "hidden",
                overflowY: "auto"
              },
              children: /*#__PURE__*/_jsx(YearsScroll, {
                year: displayedYear
              })
            }), /*#__PURE__*/_jsx("i", {
              onClick: () => {
                toggleYearMenu();
                scrollToPickedYear();
              }
            })]
          }), /*#__PURE__*/_jsx("button", {
            type: "button",
            className: "xdsoft_next",
            style: {
              visibility: "visible"
            },
            onClick: () => {
              if (displayedMonth !== 11) {
                setDisplayedMonth(displayedMonth + 1);
              } else {
                setDisplayedYear(Number(displayedYear) + 1);
                setDisplayedMonth(0);
              }
            }
          })]
        }), /*#__PURE__*/_jsx("div", {
          className: "xdsoft_calendar",
          children: /*#__PURE__*/_jsx(GenerateDays, {
            year: displayedYear,
            month: displayedMonth
          })
        }), /*#__PURE__*/_jsx("button", {
          type: "button",
          className: "xdsoft_save_selected blue-gradient-button",
          style: {
            display: "none"
          },
          children: "Save Selected"
        })]
      })
    })]
  });
};
DatePicker.propTypes = {
  id: PropTypes.string.isRequired,
  yearsBackWard: PropTypes.number,
  yearsForward: PropTypes.number
};
export default DatePicker;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="datePicker.html">datePicker</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Thu Nov 09 2023 20:44:19 GMT+0100 (Central European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
